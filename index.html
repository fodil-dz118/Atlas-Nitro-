<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Atlas Nitro - Ø§Ø±Ø¨Ø­ Ù†ÙŠØªØ±Ùˆ Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</title>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        :root {
            --atlas-blue: #5865F2; /* Ù„ÙˆÙ† Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ */
            --nitro-pink: #ff73fa; /* Ù„ÙˆÙ† Ø§Ù„Ù†ÙŠØªØ±Ùˆ */
            --dark-bg: #1e1f22;    /* Ø®Ù„ÙÙŠØ© Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ */
            --card-bg: #2b2d31;    /* Ø®Ù„ÙÙŠØ© Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--dark-bg);
            color: white;
            margin: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .app-container {
            width: 90%;
            max-width: 400px;
            background: var(--card-bg);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.4);
            text-align: center;
            border: 1px solid #3f4147;
        }

        .profile-img-container {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid var(--atlas-blue);
            box-shadow: 0 0 20px rgba(88, 101, 242, 0.4);
            margin: 0 auto 20px;
            background: white;
        }
        .profile-img-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        h1 { margin: 10px 0; font-size: 26px; }
        .subtitle { color: #b5bac1; font-size: 14px; margin-bottom: 25px; }

        .hidden { display: none; }

        input {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid #1e1f22;
            background: #40444b;
            color: white;
            box-sizing: border-box;
            text-align: center;
            outline: none;
        }

        button {
            width: 100%;
            padding: 14px;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
            margin-top: 10px;
        }
        .btn-primary { background: var(--atlas-blue); color: white; }
        .btn-nitro { background: var(--nitro-pink); color: white; }
        button:hover { opacity: 0.9; transform: scale(0.98); }

        .points-box {
            background: linear-gradient(135deg, var(--atlas-blue), var(--nitro-pink));
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        .points-value { font-size: 38px; font-weight: 800; display: block; }

        #ad-overlay {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.98); z-index: 9999;
            flex-direction: column; justify-content: center; align-items: center;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø¥Ø¶Ø§ÙÙŠ Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ */
        .discord-top-img { width: 100px; margin-bottom: 10px; }
    </style>
</head>
<body>

    <div class="app-container">
        
        <div id="step-login">
            <img src="Discord.png" alt="Discord Logo" class="discord-top-img">
            
            <h1>Atlas Nitro</h1>
            <p class="subtitle">Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ø¹Ø¨Ø± Ø¬ÙˆØ¬Ù„ Ù„Ù„Ø¨Ø¯Ø¡</p>
            
            <div id="g_id_onload"
                 data-client_id="1035748084009-cop81ce2crdq16pfeanrtq3odgkcmm4k.apps.googleusercontent.com"
                 data-callback="onSignIn">
            </div>
            <div style="display: flex; justify-content: center;">
                <div class="g_id_signin" data-type="standard" data-shape="pill" data-theme="filled_blue" data-size="large"></div>
            </div>
        </div>

        <div id="step-data" class="hidden">
            <h2>Ø£ÙƒÙ…Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ</h2>
            <p class="subtitle">ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù…Ùƒ ÙˆØªØ§Ø±ÙŠØ® Ù…ÙŠÙ„Ø§Ø¯Ùƒ</p>
            <input type="text" id="nameInput" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
            <input type="text" id="dobInput" placeholder="ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ DD/MM/YYYY">
            <button class="btn-primary" onclick="finishSetup()">Ø¯Ø®ÙˆÙ„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚</button>
        </div>

        <div id="step-main" class="hidden">
            <div style="text-align: right; font-size: 13px; color: #b5bac1;">Ù…Ø±Ø­Ø¨Ø§Ù‹ØŒ <span id="display-name" style="color: white; font-weight: bold;"></span></div>
            <div class="points-box">
                <span class="points-value" id="points-count">0</span>
                <span>Ù†Ù‚Ø·Ø© Atlas</span>
            </div>
            <button class="btn-primary" onclick="showAd()">ğŸ“º Ù…Ø´Ø§Ù‡Ø¯Ø© Ø¥Ø¹Ù„Ø§Ù† (+30 Ù†Ù‚Ø·Ø©)</button>
            <button class="btn-nitro" onclick="redeem()">ğŸ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù†ÙŠØªØ±Ùˆ (3000 Ù†Ù‚Ø·Ø©)</button>
            <p style="font-size: 11px; color: #80848e; margin-top: 15px;">ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ù„Ø¶Ù…Ø§Ù† Ø­Ù‚ÙŠÙ‚Ø© Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª</p>
            <button onclick="logout()" style="background:none; color:#ed4245; border:none; font-size:12px; cursor:pointer; margin-top:10px;">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
        </div>

    </div>

    <div id="ad-overlay">
        <h2 style="color: var(--nitro-pink);">Ø¥Ø¹Ù„Ø§Ù† Atlas Nitro</h2>
        <p>Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠÙ†ØªÙ‡ÙŠ Ø§Ù„Ø¹Ø¯Ø§Ø¯: <span id="ad-timer" style="font-weight: bold; font-size: 22px;">15</span></p>
        <div style="width: 300px; height: 250px; background: #333; border: 2px dashed #555; display: flex; align-items: center; justify-content: center; border-radius: 10px;">
            <p style="color: #888;">[ Ø¥Ø¹Ù„Ø§Ù† Ø­Ù‚ÙŠÙ‚ÙŠ ÙŠØ¸Ù‡Ø± Ù‡Ù†Ø§ ]</p>
        </div>
    </div>

    <script>
        let currentUserId = null;

        // ÙÙƒ ØªØ´ÙÙŠØ± Ø§Ù„ØªÙˆÙƒÙ† Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ID Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        function parseJwt(token) {
            let base64Url = token.split('.')[1];
            let base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            return JSON.parse(window.atob(base64));
        }

        function onSignIn(response) {
            const userData = parseJwt(response.credential);
            currentUserId = userData.sub; // Ø§Ù„Ù…Ø¹Ø±Ù Ø§Ù„ÙØ±ÙŠØ¯ Ù„Ø­Ø³Ø§Ø¨ Ø¬ÙˆØ¬Ù„

            // Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬Ù„Ø¨ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù…Ø®Ø²Ù†Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹ Ù„Ù‡Ø°Ø§ Ø§Ù„Ø­Ø³Ø§Ø¨ ØªØ­Ø¯ÙŠØ¯Ø§Ù‹
            const savedData = localStorage.getItem('atlas_user_' + currentUserId);

            if (savedData) {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø³Ø¬Ù„Ø§Ù‹ Ø³Ø§Ø¨Ù‚Ø§Ù‹ØŒ Ø§Ø¯Ø®Ù„ Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ù„Ù…ØªØ¬Ø±
                const user = JSON.parse(savedData);
                showDashboard(user.name, user.points);
            } else {
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¬Ø¯ÙŠØ¯Ø§Ù‹ØŒ Ø§Ø·Ù„Ø¨ Ø§Ù„Ø§Ø³Ù… ÙˆØ§Ù„Ù…ÙŠÙ„Ø§Ø¯
                document.getElementById('step-login').classList.add('hidden');
                document.getElementById('step-data').classList.remove('hidden');
                document.getElementById('nameInput').value = userData.name;
            }
        }

        function finishSetup() {
            const name = document.getElementById('nameInput').value;
            const dob = document.getElementById('dobInput').value;

            if (name.trim() === "" || dob.trim() === "") {
                alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø®Ø§Ù†Ø§Øª");
                return;
            }

            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯
            const newUser = { name: name, dob: dob, points: 0 };
            localStorage.setItem('atlas_user_' + currentUserId, JSON.stringify(newUser));
            
            showDashboard(name, 0);
        }

        function showDashboard(name, points) {
            document.getElementById('display-name').innerText = name;
            document.getElementById('points-count').innerText = points;
            document.getElementById('step-login').classList.add('hidden');
            document.getElementById('step-data').classList.add('hidden');
            document.getElementById('step-main').classList.remove('hidden');
        }

        function showAd() {
            const overlay = document.getElementById('ad-overlay');
            const timerEl = document.getElementById('ad-timer');
            let timeLeft = 15;
            overlay.style.display = 'flex';
            
            const interval = setInterval(() => {
                timeLeft--;
                timerEl.innerText = timeLeft;
                if (timeLeft <= 0) {
                    clearInterval(interval);
                    overlay.style.display = 'none';
                    updatePoints(30);
                }
            }, 1000);
        }

        function updatePoints(amount) {
            let user = JSON.parse(localStorage.getItem('atlas_user_' + currentUserId));
            user.points += amount;
            localStorage.setItem('atlas_user_' + currentUserId, JSON.stringify(user));
            document.getElementById('points-count').innerText = user.points;
            alert("Ø¹Ù…Ù„ Ø±Ø§Ø¦Ø¹! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ 30 Ù†Ù‚Ø·Ø©.");
        }

        function logout() {
            location.reload(); 
        }

        function redeem() {
            let user = JSON.parse(localStorage.getItem('atlas_user_' + currentUserId));
            if (user.points >= 3000) {
                alert("Ø·Ù„Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©! Ø³ÙŠØªÙ… Ø¥Ø±Ø³Ø§Ù„ ÙƒÙˆØ¯ Ø§Ù„Ù†ÙŠØªØ±Ùˆ Ù‚Ø±ÙŠØ¨Ø§Ù‹.");
            } else {
                alert("Ø±ØµÙŠØ¯Ùƒ ØºÙŠØ± ÙƒØ§ÙÙ. ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ " + (3000 - user.points) + " Ù†Ù‚Ø·Ø© Ø¥Ø¶Ø§ÙÙŠØ©.");
            }
        }
    </script>
</body>
</html>
